<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"> <!-- 规定视口区域大小为1:1且不允许缩放 -->
<meta name="apple-mobile-web-app-capable" content="yes"> <!-- IOS中Safari允许全屏浏览 -->
<meta name="apple-mobile-web-app-status-bar-style" content="black"> <!-- IOS中Safari顶端状态条样式 -->
<meta content="telephone=no, address=no" name="format-detection"> <!-- 忽略IOS操作系统将五位或以上位数的数字识别成电话号码 -->
<meta name="author" content="BeZuo">
<title>懒人凑团</title>
<link rel="Shortcut Icon" href="images/favicon.ico" />
<!-- 用于浏览器默认样式重置 start -->
<link type="text/css" rel="stylesheet" href="../style/base.min.css" />
<!-- / 用于浏览器默认样式重置 end -->

<!-- 页面模块样式 start -->
<link type="text/css" rel="stylesheet" href="../style/layout.min.css" />
<!-- / 页面模块样式 end -->

<!-- 页面下拉加载动效 start -->
<link rel="stylesheet" type="text/css" href="../style/gmu.min.css" />
<!-- / 页面下拉加载动效 end -->

<!-- 页面下拉加载动效 start -->
<link rel="stylesheet" type="text/css" href="../style/loading.min.css" />
<!-- 页面下拉加载动效 end -->
</head>

<body class="bg01">
<section>	
	<!-- header start -->
	<header class="top-fixed header">
		<a href="javascript: history.back();" class="fn-left iconfont page-back"></a>
		<h1 class="top-h1">懒人凑团</h1>
	</header>
	<!-- / header end -->

	<!-- article start -->
	<article class="pad-top44 ct-box ui-refresh" style="margin:0;">
		<ul class="fn-clear ct-list">
			<li data-href="groupBuy05.html">
				<div class="ct-item">
					<a href="groupBuy01.html" class="fn-right btn-join">参团</a>
					<span class="fn-left ct-user">
						<img src="https://avatars2.githubusercontent.com/u/6670763?v=3&amp;s=460">
					</span>
					<div class="fn-left ">
						<h5>你叫王二小</h5>
						<p>剩余<em class="text-color ct-time" data-end="229000"><!-- 00 : 03 : 49 --></em>结束<i>仅差<em class="text-color">2</em>人</i></p>
					</div>
				</div>
			</li>

			<li data-href="groupBuy05.html">
				<div class="ct-item">
					<a href="groupBuy02.html" class="fn-right btn-join">参团</a>
					<span class="fn-left ct-user">
						<img src="http://img5.iqilu.com/c/u/2013/1216/1387181465423.jpg">
					</span>
					<div class="fn-left ">
						<h5>骑着蜗牛追美女</h5>
						<p>剩余<em class="text-color ct-time" data-end="0"><!-- 00 : 00 : 00 --></em>结束<i>仅差<em class="text-color">2</em>人</i></p>
					</div>
				</div>
			</li>

			<li data-href="groupBuy05.html">
				<div class="ct-item">
					<a href="groupBuy03.html" class="fn-right btn-join">参团</a>
					<span class="fn-left ct-user">
						<img src="http://ftp.ytbbs.com/attachments/forum/201404/14/165935vfzw45q2574ggvii.gif">
					</span>
					<div class="fn-left ">
						<h5>无量天尊-阿弥陀佛</h5>
						<p>剩余<em class="text-color ct-time" data-end="82944000"><!-- 23 : 02 : 24 --></em>结束<i>仅差<em class="text-color">2</em>人</i></p>
					</div>
				</div>
			</li>

			<li data-href="groupBuy05.html">
				<div class="ct-item">
					<a href="groupBuy04.html" class="fn-right btn-join">参团</a>
					<span class="fn-left ct-user">
						<img src="https://avatars2.githubusercontent.com/u/6670763?v=3&amp;s=460">
					</span>
					<div class="fn-left ">
						<h5>你叫王二小</h5>
						<p>剩余<em class="text-color ct-time" data-end="229000"><!-- 00 : 03 : 49 --></em>结束<i>仅差<em class="text-color">2</em>人</i></p>
					</div>
				</div>
			</li>

			<li data-href="groupBuy05.html">
				<div class="ct-item">
					<a href="groupBuy05.html" class="fn-right btn-join">参团</a>
					<span class="fn-left ct-user">
						<img src="http://img5.iqilu.com/c/u/2013/1216/1387181465423.jpg">
					</span>
					<div class="fn-left ">
						<h5>骑着蜗牛追美女</h5>
						<p>剩余<em class="text-color ct-time" data-end="0"><!-- 00 : 00 : 00 --></em>结束<i>仅差<em class="text-color">2</em>人</i></p>
					</div>
				</div>
			</li>

		</ul>

		<!--setup方式带有class为ui-refresh-down或ui-refresh-up的元素必须加上，用于放refresh按钮-->
		<div class="ui-refresh-down"></div>	
	</article>
	<!-- / article end -->
</section>

<script type="text/javascript" src="../js/zepto.min.js"></script>
<script type="text/javascript" src="../js/base.min.js"></script>
<script type="text/javascript" src="../js/gmu.min.js"></script>
<script type="text/javascript">
	// 倒计时插件
	$(".ct-time").countdown();

	/*组件初始化js start*/
	$('.ui-refresh').refresh({
	    load: function (dir, type) {
	        var me = this;
	        var promptUp = $("<div class='prompt-up'>没有更多内容了</div>");
	        var promptDown = $("<div class='prompt-down'>没有更多内容了</div>");

	        // 向上拉且上一次上拉请求数据不为空, 或下拉且上一次下拉请求数据不为空 	
	        if ($(".prompt-down").length === 0) {

	        	setTimeout(function(){
	        		// 向服务器发送一个请求, 并 
		            $.getJSON('../json/list.json', function (data) {
			            var result = '',
			            	list = $('.ct-list');

		            	// 对请求回来的数据进行判断是否为空
		            	// 不为空：将请求回来的json数据拼接成字符串并将数据插入至对应的方向
		            	// 为空：则在直接禁用相应的拉动刷新且页面上添加提示 ———— 没有更多内容了
						if (data !== null) {

			                // 判断拉动方向将拼接的数据插入
			                list[dir == 'up' ? 'prepend' : 'append'](strList(data,result ));
			                //数据加载完成后改变状态
			            	me.afterDataLoading(dir);
			            	// 倒计时插件
							$(".ct-time").countdown();

		                } else {
				        	// 将没有更多数据友好提示添加至页面
		        			$(".ui-refresh-down").hide().children().removeClass();
			            	me.afterDataLoading(dir);
				        	return dir !== 'up' ? $(".ui-refresh").append(promptUp) : $(".ui-refresh").before(promptDown);
				        }
				    });
	        	},500);
	        }
	    }
	});
	/*组件初始化js end */

	// 字符串拼接
	function strList(data,result){
		for(var i = 0, len = data.lists.length; i < len; i++){
            
			result+="<li data-href='groupBuy01.html'>" +
						"<a href='#' class='fn-right btn-join'>参团</a>" +
						"<span class='fn-left ct-user'>" +
							"<img src='https://avatars2.githubusercontent.com/u/6670763?v=3&amp;s=460'>" +
						"</span>" +

						"<div class='fn-left'>" +
							"<h5>你叫王二小</h5>" +
							"<p>剩余<em class='text-color ct-time' data-end='229000'></em>结束<i>仅差<em class='text-color'>2</em>人</i></p>" +
						"</div>" +
					"</li>";
        };
        return result;
	}
</script>
</body>
</html>